<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kult: Divindade Perdida - Web Reader</title>
    <link rel="icon" type="image/png" href="ICON/ICON.PNG">
    
    <script src="js/jquery.js"></script>
    <script src="js/turn.min.js"></script>

    <style>
        * { 
            margin: 0; padding: 0; box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent; 
            user-select: none; 
            -webkit-user-drag: none;
        }
        body { background-color: #000; overflow: hidden; display: flex; justify-content: center; align-items: center; height: 100vh; }

        #canvas { position: relative; width: 100vw; height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        
        #book-wrapper { 
            position: relative; width: 900px; height: 600px; 
            z-index: 5; 
            cursor: default;
            transition: transform 0.4s cubic-bezier(0.2, 0, 0.2, 1), left 0.4s cubic-bezier(0.2, 0, 0.2, 1), top 0.4s cubic-bezier(0.2, 0, 0.2, 1);
        }

        #flipbook { width: 900px; height: 600px; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .page { background-color: #000; }
        .page img { width: 100%; height: 100%; object-fit: contain; pointer-events: none; }

        /* ESTADOS DE ZOOM E DRAG */
        .zoom-extra { transform: scale(2.2) !important; z-index: 1000 !important; cursor: grab !important; }
        .zoom-active-drag { cursor: grabbing !important; transition: none !important; }

        .interface-fade { 
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out !important; 
            opacity: 1;
        }
        .interface-hidden { opacity: 0 !important; pointer-events: none !important; }

        .contadores-container { position: absolute; bottom: -40px; width: 100%; display: flex; justify-content: space-between; z-index: 100; pointer-events: none; }
        .num-impact { 
            width: 150px; text-align: center; font-family: 'Arial', sans-serif; font-weight: bold; font-size: 28px; 
            color: #9a8c65; text-shadow: 0 0 1px rgba(154, 140, 101, 0.5), 2px 2px 4px rgba(0,0,0,0.8); 
        }

        /* --- SETAS DE FORA COM FADE NO GLOW --- */
        .seta { 
            position: absolute; top: 50%; transform: translateY(-50%) scale(1); font-size: 60px; 
            color: #998b66cc; cursor: pointer; z-index: 200;
            text-shadow: 0 0 0px rgba(154, 140, 101, 0); 
            transition: text-shadow 0.5s ease-in-out, color 0.5s ease-in-out, transform 0.3s cubic-bezier(0.15, 0.85, 0.35, 1.5);
        }
        .seta:hover { 
            color: #d2c091cc; 
            text-shadow: 0 0 10px #998b6652, 0 0 30px rgba(154, 140, 101, 0.4); 
        }
        .seta:active { transform: translateY(-50%) scale(1.4) !important; transition: transform 0.3s ease-out !important; }

        #prev { left: -100px; }
        #next { right: -100px; }

        .busca-wrapper { position: absolute; left: 50%; bottom: 3px; transform: translateX(-50%); z-index: 101; display: flex; gap: 10px; align-items: center; }
        
        #btn-busca, #btn-lupa { 
            font-family: 'Arial', sans-serif; font-weight: bold;
            color: #9a8c65; background: transparent; border: 2px solid #9a8c65; 
            cursor: pointer; transition: all 0.4s ease; 
        }
        #btn-busca { font-size: 14px; padding: 8px 20px; height: 37px; }
        #btn-lupa { width: 50px; height: 37px; font-size: 28px; display: flex; align-items: center; justify-content: center; padding: 0; }
        #btn-busca:hover, #btn-lupa:hover { background: rgba(154, 140, 101, 0.1); box-shadow: 0 0 15px #9a8c65; color: #d4c59b; }
        #btn-busca:active, #btn-lupa:active { transform: scale(1.1); }

        /* PAINÉIS */
        #painel-ir-pagina, #painel-capitulos { 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            background: #000; border: 2px solid #9a8c65; z-index: 10000; display: none; box-shadow: 0 0 50px #000; 
        }
        #painel-ir-pagina { width: 200px; padding: 20px; text-align: center; }
        #painel-capitulos { width: 320px; height: 380px; overflow: hidden; }
        
        #painel-capitulos.active, #painel-ir-pagina.active { display: block; animation: fadeIn 0.3s ease; }
        
        /* LIMPEZA DO INPUT DA LUPA */
        #painel-ir-pagina input { 
            width: 100px; background: transparent !important; border: 1px solid #9a8c65; 
            color: #9a8c65; padding: 10px; text-align: center; font-family: Arial; 
            font-weight: bold; margin-bottom: 15px; outline: none; font-size: 18px;
            -moz-appearance: textfield;
        }
        #painel-ir-pagina input::-webkit-outer-spin-button,
        #painel-ir-pagina input::-webkit-inner-spin-button { 
            -webkit-appearance: none; margin: 0;
        }
        
        .btn-fechar { position: absolute; top: 10px; right: 12px; color: #9a8c65; cursor: pointer; font-family: Arial; font-weight: bold; z-index: 11; }
        
        /* SUMÁRIO */
        .sumario-page { display: none; flex-direction: column; height: 100%; padding-top: 35px; overflow: hidden; }
        .sumario-page.active { display: flex; }
        .lista-capitulos { flex-grow: 1; display: flex; flex-direction: column; overflow: hidden; }
        .cap-item { 
            font-family: 'Arial', sans-serif; font-weight: bold; color: #9a8c65; 
            height: 58px; padding: 0 20px; cursor: pointer; text-transform: uppercase; 
            font-size: 11px; border-bottom: 1px solid rgba(154, 140, 101, 0.1); 
            transition: 0.3s ease; display: flex; align-items: center; flex-shrink: 0;
        }
        .cap-item:hover { background: #9a8c65; color: #000; padding-left: 25px; }
        .sumario-footer { height: 55px; display: flex; justify-content: center; align-items: center; border-top: 1px solid rgba(154, 140, 101, 0.2); gap: 20px; margin-top: auto; }
        .seta-interna { color: #9a8c65; cursor: pointer; font-size: 30px; transition: 0.4s ease; width: 50px; text-align: center; }
        .seta-interna:hover { color: #d4c59b; transform: scale(1.2); text-shadow: 0 0 10px #9a8c65; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <div id="canvas">
        <div id="book-wrapper">
            <div id="prev" class="seta interface-fade">&#8606;</div>
            <div id="flipbook"></div>
            <div id="next" class="seta interface-fade">&#8608;</div>
            <div class="contadores-container interface-fade">
                <div id="num-esq" class="num-impact"></div>
                <div id="num-dir" class="num-impact"></div>
            </div>
        </div>
        <div class="busca-wrapper interface-fade">
            <button id="btn-busca">SUMÁRIO</button>
            <button id="btn-lupa">&#9906;</button>
        </div>
    </div>

    <div id="painel-ir-pagina">
        <div class="btn-fechar" onclick="$('#painel-ir-pagina').removeClass('active')">X</div>
        <div style="color: #9a8c65; font-family: Arial; font-size: 12px; margin-bottom: 15px; font-weight: bold;">IR PARA A PÁGINA</div>
        <input type="number" id="input-pagina">
        <button id="btn-confirmar-pg" style="background: #9a8c65; border: none; color: #000; padding: 8px 15px; font-weight: bold; cursor: pointer; display: block; margin: 0 auto; width: 100%;">OK</button>
    </div>

    <div id="painel-capitulos">
        <div class="btn-fechar" onclick="$('#painel-capitulos').removeClass('active')">X</div>
        
        <div class="sumario-page active" id="aba-0">
            <div class="lista-capitulos">
                <div class="cap-item" data-page="1">Capa</div>
                <div class="cap-item" data-page="8">Lista de Capítulos</div>
                <div class="cap-item" data-page="40">Livro I: A Mentira</div>
                <div class="cap-item" data-page="146">Livro II: A Loucura</div>
                <div class="cap-item" data-page="207">Livro III: O Purgatório</div>
            </div>
            <div class="sumario-footer"><div class="seta-interna" onclick="irParaAba(1)">&#8608;</div></div>
        </div>

        <div class="sumario-page" id="aba-1">
            <div class="lista-capitulos">
                <div class="cap-item" data-page="42">1. Um Mundo na Escuridão</div>
                <div class="cap-item" data-page="48">2. Arquétipos</div>
                <div class="cap-item" data-page="92">3. Traços do Personagem</div>
                <div class="cap-item" data-page="126">4. O Personagem Jogador</div>
                <div class="cap-item" data-page="148">5. A Mestra do Jogo</div>
            </div>
            <div class="sumario-footer">
                <div class="seta-interna" onclick="irParaAba(0)">&#8606;</div>
                <div class="seta-interna" onclick="irParaAba(0)">&#8697;</div>
                <div class="seta-interna" onclick="irParaAba(2)">&#8608;</div>
            </div>
        </div>

        <div class="sumario-page" id="aba-2">
            <div class="lista-capitulos">
                <div class="cap-item" data-page="168">6. Preparando a História</div>
                <div class="cap-item" data-page="176">7. Preparando a História II</div>
                <div class="cap-item" data-page="182">8. Influências</div>
                <div class="cap-item" data-page="194">9. Entreato</div>
                <div class="cap-item" data-page="202">10. Construindo um Cenário</div>
            </div>
            <div class="sumario-footer">
                <div class="seta-interna" onclick="irParaAba(1)">&#8606;</div>
                <div class="seta-interna" onclick="irParaAba(0)">&#8697;</div>
                <div class="seta-interna" onclick="irParaAba(3)">&#8608;</div>
            </div>
        </div>

        <div class="sumario-page" id="aba-3">
            <div class="lista-capitulos">
                <div class="cap-item" data-page="208">11. Além do Véu</div>
                <div class="cap-item" data-page="222">12. A Ilusão</div>
                <div class="cap-item" data-page="228">13. Elysium</div>
                <div class="cap-item" data-page="246">14. Além da Loucura</div>
                <div class="cap-item" data-page="258">15. Além da Paixão</div>
            </div>
            <div class="sumario-footer">
                <div class="seta-interna" onclick="irParaAba(2)">&#8606;</div>
                <div class="seta-interna" onclick="irParaAba(0)">&#8697;</div>
                <div class="seta-interna" onclick="irParaAba(4)">&#8608;</div>
            </div>
        </div>

        <div class="sumario-page" id="aba-4">
            <div class="lista-capitulos">
                <div class="cap-item" data-page="266">16. Além dos Sonhos</div>
                <div class="cap-item" data-page="280">17. O Submundo</div>
                <div class="cap-item" data-page="294">18. Metropolis</div>
                <div class="cap-item" data-page="318">19. Inferno</div>
                <div class="cap-item" data-page="334">20. Gaia</div>
            </div>
            <div class="sumario-footer">
                <div class="seta-interna" onclick="irParaAba(3)">&#8606;</div>
                <div class="seta-interna" onclick="irParaAba(0)">&#8697;</div>
                <div class="seta-interna" onclick="irParaAba(5)">&#8608;</div>
            </div>
        </div>

        <div class="sumario-page" id="aba-5">
            <div class="lista-capitulos">
                <div class="cap-item" data-page="344">21. Pactos e Magia</div>
                <div class="cap-item" data-page="352">22. O Despertar</div>
            </div>
            <div class="sumario-footer">
                <div class="seta-interna" onclick="irParaAba(4)">&#8606;</div>
                <div class="seta-interna" onclick="irParaAba(0)">&#8697;</div>
            </div>
        </div>
    </div>

    <script>
        const totalPaginas = 392; 
        const book = $('#flipbook');
        const wrapper = $('#book-wrapper');
        let isDragging = false, startX, startY, scrollX = 0, scrollY = 0;

        for (let i = 1; i <= totalPaginas; i++) {
            book.append(`<div class="page"><img src="paginas/Kult (${i}).jpg"></div>`);
        }

        book.turn({ 
            width: 900, height: 600, acceleration: true, 
            when: { turning: function(e, page) { atualizarInterface(page); } } 
        });

        // TECLADO: SETAS E A/D
        $(document).keydown(function(e) {
            if (e.keyCode == 37 || e.keyCode == 65) book.turn('previous'); // Seta Esq ou A
            else if (e.keyCode == 39 || e.keyCode == 68) book.turn('next'); // Seta Dir ou D
        });

        function irParaAba(index) {
            $('.sumario-page').removeClass('active');
            $('#aba-' + index).addClass('active');
        }

        function resetZoom() {
            wrapper.removeClass('zoom-extra').css({ 'left': '0px', 'top': '0px' });
            $('.interface-fade').removeClass('interface-hidden');
            scrollX = 0; scrollY = 0;
        }

        function atualizarInterface(page) {
            resetZoom();
            let pEsq = (page === 1) ? null : (page % 2 === 0 ? page : page - 1);
            let pDir = (page === 1) ? 1 : pEsq + 1;
            const formatar = (p) => { if (!p || p < 5 || p > totalPaginas) return null; let n = p - 4; return n < 10 ? '0' + n : n; };
            $('#num-esq').text(formatar(pEsq) || '').css('opacity', formatar(pEsq) ? 1 : 0);
            $('#num-dir').text(formatar(pDir) || '').css('opacity', formatar(pDir) ? 1 : 0);
            let pageShift = (page === 1) ? -225 : (page >= totalPaginas ? 225 : 0);
            wrapper.css('transform', `translateX(${pageShift}px)`);
            page === 1 ? $('#prev').hide() : $('#prev').show();
            page >= totalPaginas ? $('#next').hide() : $('#next').show();
        }

        book.on('dblclick', function(e) {
            e.stopPropagation();
            if (wrapper.hasClass('zoom-extra')) resetZoom();
            else {
                $('.interface-fade').addClass('interface-hidden');
                const offset = $(this).offset();
                const posX = ((e.pageX - offset.left) / $(this).width()) * 100;
                const posY = ((e.pageY - offset.top) / $(this).height()) * 100;
                wrapper.css('transform-origin', `${posX}% ${posY}%`).addClass('zoom-extra');
            }
        });

        $(document).on('mousedown', function(e) {
            if (wrapper.hasClass('zoom-extra')) {
                isDragging = true;
                wrapper.addClass('zoom-active-drag');
                startX = e.pageX - scrollX; startY = e.pageY - scrollY;
                e.preventDefault();
            }
        }).on('mousemove', function(e) {
            if (isDragging) {
                scrollX = e.pageX - startX; scrollY = e.pageY - startY;
                wrapper.css({ 'left': scrollX + 'px', 'top': scrollY + 'px' });
            }
        }).on('mouseup', function() { isDragging = false; wrapper.removeClass('zoom-active-drag'); });

        $('#btn-busca').click(() => { $('#painel-ir-pagina').removeClass('active'); $('#painel-capitulos').toggleClass('active'); });
        $('#btn-lupa').click(() => { $('#painel-capitulos').removeClass('active'); $('#painel-ir-pagina').toggleClass('active'); $('#input-pagina').val('').focus(); });
        
        function confirmarPagina() {
            let pgDigitada = parseInt($('#input-pagina').val());
            let pgReal = pgDigitada + 4; 
            if (pgReal >= 1 && pgReal <= totalPaginas) {
                book.turn('page', pgReal);
                $('#painel-ir-pagina').removeClass('active');
            } else { alert("Página inválida!"); }
        }

        $('#btn-confirmar-pg').click(confirmarPagina);
        $('#input-pagina').keypress(function(e) { if(e.which == 13) confirmarPagina(); });

        $('.cap-item').click(function() { book.turn('page', $(this).data('page')); $('#painel-capitulos').removeClass('active'); });

        $('#prev').click(() => book.turn('previous'));
        $('#next').click(() => book.turn('next'));

        atualizarInterface(1);
    </script>
</body>
</html>